# 任务索引

**总任务数**: 21
**已完成**: 0
**进行中**: 0
**待开始**: 20
**已锁定**: 1

**项目名称**: 设置系统完善
**创建时间**: 2026-01-31 16:14:01

## 任务列表

| ID | 标题 | 状态 | 优先级 | 预计时间 | 依赖任务 | 占用者 | 锁定时间 |
|----|------|------|--------|----------|----------|--------|----------|
| 任务001 | 实现 Tauri 后端存储命令 | Todo | High | 3h | - | - | - |
| 任务002 | 创建 Settings Context 和 Hook | Todo | High | 4h | 任务001 | - | - |
| 任务003 | 重构 SettingsPanel 使用 Context | Todo | High | 2h | 任务002 | - | - |
| 任务004 | 应用外观设置（Theme, FontSize, MessageSpacing） | Todo | High | 3h | 任务002 | - | - |
| 任务005 | 应用代码块主题设置 | Todo | Medium | 2h | 任务004 | - | - |
| 任务006 | 修复 sidebarWidth 数据一致性 | Todo | High | 1.5h | 任务002 | - | - |
| 任务007 | 应用会话设置（ViewMode, AutoRefresh） | Todo | High | 2.5h | 任务002 | - | - |
| 任务008 | 应用会话预览设置（ShowPreview, PreviewLines） | Todo | Medium | 2h | 任务007 | - | - |
| 任务009 | 应用搜索设置（SearchMode, CaseSensitive, IncludeTools） | Todo | High | 2h | 任务002 | - | - |
| 任务010 | 应用导出设置（Format, Metadata, Timestamps） | Todo | Medium | 1.5h | 任务002 | - | - |
| 任务011 | 应用终端设置（Terminal, PiCommandPath） | Todo | Medium | 2h | 任务002 | - | - |
| 任务012 | 应用高级设置（SessionDir, Cache, Debug） | Todo | Medium | 2h | 任务002 | - | - |
| 任务013 | 添加设置输入验证 | Todo | Medium | 2h | 任务003 | - | - |
| 任务014 | 统一 Pi Config 处理 | Todo | Medium | 2h | 任务002 | - | - |
| 任务015 | 添加未保存提示 | Todo | Low | 1h | 任务003 | - | - |
| 任务016 | 实现设置搜索功能 | Todo | Low | 2h | 任务003 | - | - |
| 任务017 | 添加键盘快捷键 | Todo | Low | 1h | 任务003 | - | - |
| 任务018 | 设置导入/导出功能 | Todo | Low | 2h | 任务013 | - | - |
| 任务019 | 编写测试用例 | Todo | Medium | 3h | 任务002, 任务013 | - | - |
| 任务020 | 文档更新 | Todo | Low | 1.5h | 任务018 | - | - |
| 任务021 | 端到端测试 | Todo | Medium | 2h | 任务019 | - | - |

## 依赖关系图

```
任务001 (实现 Tauri 后端存储命令)
任务001 └─→ 任务002 (创建 Settings Context 和 Hook)
任务002 └─→ 任务003 (重构 SettingsPanel 使用 Context)
任务002 └─→ 任务004 (应用外观设置（Theme, FontSize, MessageSpacing）)
任务004 └─→ 任务005 (应用代码块主题设置)
任务002 └─→ 任务006 (修复 sidebarWidth 数据一致性)
任务002 └─→ 任务007 (应用会话设置（ViewMode, AutoRefresh）)
任务007 └─→ 任务008 (应用会话预览设置（ShowPreview, PreviewLines）)
任务002 └─→ 任务009 (应用搜索设置（SearchMode, CaseSensitive, IncludeTools）)
任务002 └─→ 任务010 (应用导出设置（Format, Metadata, Timestamps）)
任务002 └─→ 任务011 (应用终端设置（Terminal, PiCommandPath）)
任务002 └─→ 任务012 (应用高级设置（SessionDir, Cache, Debug）)
任务003 └─→ 任务013 (添加设置输入验证)
任务002 └─→ 任务014 (统一 Pi Config 处理)
任务003 └─→ 任务015 (添加未保存提示)
任务003 └─→ 任务016 (实现设置搜索功能)
任务003 └─→ 任务017 (添加键盘快捷键)
任务013 └─→ 任务018 (设置导入/导出功能)
任务002 └─→ 任务019 (编写测试用例)
任务013 └─→ 任务019 (编写测试用例)
任务018 └─→ 任务020 (文档更新)
任务019 └─→ 任务021 (端到端测试)
```

## 可并行任务分组

### 批次 1（等待 初始化 完成）
- 任务001: 实现 Tauri 后端存储命令 (依赖: 无依赖)


### 批次 2（等待 批次1 完成）
- 任务002: 创建 Settings Context 和 Hook (依赖: 任务001)


### 批次 3（等待 批次2 完成）
- 任务003: 重构 SettingsPanel 使用 Context (依赖: 任务002)
  - 任务004: 应用外观设置（Theme, FontSize, MessageSpacing） (依赖: 任务002)
  - 任务006: 修复 sidebarWidth 数据一致性 (依赖: 任务002)
  - 任务007: 应用会话设置（ViewMode, AutoRefresh） (依赖: 任务002)
  - 任务009: 应用搜索设置（SearchMode, CaseSensitive, IncludeTools） (依赖: 任务002)
  - 任务010: 应用导出设置（Format, Metadata, Timestamps） (依赖: 任务002)
  - 任务011: 应用终端设置（Terminal, PiCommandPath） (依赖: 任务002)
  - 任务012: 应用高级设置（SessionDir, Cache, Debug） (依赖: 任务002)
  - 任务014: 统一 Pi Config 处理 (依赖: 任务002)
  ✅ 可并行执行

### 批次 4（等待 批次3 完成）
- 任务005: 应用代码块主题设置 (依赖: 任务004)
  - 任务008: 应用会话预览设置（ShowPreview, PreviewLines） (依赖: 任务007)
  - 任务013: 添加设置输入验证 (依赖: 任务003)
  - 任务015: 添加未保存提示 (依赖: 任务003)
  - 任务016: 实现设置搜索功能 (依赖: 任务003)
  - 任务017: 添加键盘快捷键 (依赖: 任务003)
  ✅ 可并行执行

### 批次 5（等待 批次4 完成）
- 任务018: 设置导入/导出功能 (依赖: 任务013)
  - 任务019: 编写测试用例 (依赖: 任务002, 任务013)
  ✅ 可并行执行

### 批次 6（等待 批次5 完成）
- 任务020: 文档更新 (依赖: 任务018)
  - 任务021: 端到端测试 (依赖: 任务019)
  ✅ 可并行执行


## 项目目标

| 指标 | 优化前 | 目标 | 提升幅度 | 测量方法 |
|------|--------|------|----------|----------|
| 总体完成度 | 65% | 90%+ | 38% |  |
| 持久化实现 | 30% | 100% | 233% |  |
| 设置应用 | 5% | 80%+ | 1500% |  |
| 设置生效数量 | 1/23 | 18+/23 | 1700% |  |


## 执行计划（3 Agent 并行）

阶段 1:
  - Agent A: 任务001 (3h)

阶段 2:
  - Agent A: 任务002 (4h)

阶段 3:
  - Agent A: 任务003 (2h)
  - Agent B: 任务004 (3h)
  - Agent C: 任务006 (1.5h)
  - Agent A: 任务007 (2.5h)
  - Agent B: 任务009 (2h)
  - Agent C: 任务010 (1.5h)
  - Agent A: 任务011 (2h)
  - Agent B: 任务012 (2h)
  - Agent C: 任务014 (2h)

阶段 4:
  - Agent A: 任务005 (2h)
  - Agent B: 任务008 (2h)
  - Agent C: 任务013 (2h)
  - Agent A: 任务015 (1h)
  - Agent B: 任务016 (2h)
  - Agent C: 任务017 (1h)

阶段 5:
  - Agent A: 任务018 (2h)
  - Agent B: 任务019 (3h)

阶段 6:
  - Agent A: 任务020 (1.5h)
  - Agent B: 任务021 (2h)


## 执行建议

### Agent 调度方案

**3 Agent 并行执行**:
```
阶段 1: Agent A (任务001)
阶段 2: Agent A (任务002) + Agent B (任务003) + Agent C (任务004)
...
```

**2 Agent 并行执行**:
```
阶段 1: Agent A (任务001)
阶段 2: Agent A (任务002 + 任务003) + Agent B (任务004 + 任务005)
...
```

### 领用任务流程

1. 读取 `任务索引.md`
2. 查找状态为 `Todo` 的任务
3. 检查依赖任务是否都为 `Done`
4. 更新任务状态为 `Locked`，记录占用者和锁定时间
5. 更新 `任务索引.md` 中的任务状态
6. 开始执行任务

### 任务锁定规则

- 领用时立即锁定，状态: `Todo` → `Locked`
- 开始执行时，状态: `Locked` → `In Progress`
- 完成时，状态: `In Progress` → `Done`，移至 `completed/` 目录
- 阻塞时，状态: `In Progress` → `Blocked`，记录原因并释放锁定
- 锁定超时: 预计时间 × 2，超时后自动释放

## 进度概览

- 总体进度: 0%
- 已用时间: 0 小时
- 预计剩余时间: 42h